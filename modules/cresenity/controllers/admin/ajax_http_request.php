<?php defined('SYSPATH') OR die('No direct access allowed.');class Ajax_http_request_Controller extends CController {		public function index() {		$app = CApp::instance();		$app->title(clang::__('Ajax HTTP Request'));							$f = $app->add_form('form-ajax')->set_enctype('multipart/form-data');		$w = $f->add_widget();		$w->set_title('Ajax HTTP Request');		$w->set_icon('bolt');		$div = $w->add_div()->add_class('row-fluid');				$method_list = array(			'get'=>'GET',			'post'=>'POST',					);				$w->add_field()->set_label("URL")->add_control('url','text')->set_value('');		$w->add_field()->set_label("Method")->add_control('method','select')->set_list($method_list)->set_value('');		$w->add_field()->set_label("Data Request")->add_control('data_request','textarea')->add_validation(null)->set_value('');		$w->add_field()->set_label("Data Response")->add_control('data_response','textarea')->add_validation(null)->set_value('');				$acts = $w->add_action_list()->set_style('form-action');		$act_next = $acts->add_action();				$act_next->set_label('Submit')->set_submit(true);					$js = "			jQuery(document).ready(function() {				jQuery('#form-ajax').submit(function(ev) {					ev.preventDefault();					if(jQuery('#form-ajax').hasClass('loading')) return false;					jQuery('#form-ajax').addClass('loading');					var http = false;					var vUrl = $('#url').val();					var vMethod = $('#method').val();					var vData = $('#data_request').val();					if(navigator.appName == 'Microsoft Internet Explorer') {						http = new ActiveXObject('Microsoft.XMLHTTP');					} else {						http = new XMLHttpRequest();					}					if (http) {						try {							http.abort();							http.open(vMethod, vUrl, true);							http.onreadystatechange=function() {								if(http.readyState == 4) {									try {										if (http.status==200) {											$('#data_response').val(http.responseText);										} else {											$.cresenity.message('error','Error, responseCode:'+http.status);										}									} catch (err) {										alert(err);									}									jQuery('#form-ajax').removeClass('loading');								}							}  							http.send(vData);						} catch(err) {							alert(err);						}					}					/*					$.ajax({						url: $('#url').val(),						method: $('#method').val(),						dataType: 'text',						data: $('#data_request').val(),						processData: false					}).done(function(data){						$('#data_response').val(data);					}).error(function() {						$.cresenity.message('error','Error on request');					}).complete(function() {						jQuery('#form-ajax').removeClass('loading');					});					*/					//always return false					return false;				});			});		";				$app->add_js($js);		echo $app->render();			}	}
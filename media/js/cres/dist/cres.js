!function(factory){"function"==typeof define&&define.amd?define(factory):factory()}((function(){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}var Base64=function(){function Base64(){_classCallCheck(this,Base64),this._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}return _createClass(Base64,[{key:"_utf8_encode",value:function(e){e=e.replace(/rn/g,"n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t}},{key:"_utf8_decode",value:function(e){for(var t="",n=0,c2=0,r=0;n<e.length;)(r=e.charCodeAt(n))<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((31&r)<<6|63&c2),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((15&r)<<12|(63&c2)<<6|63&c3),n+=3);return t}},{key:"encode",value:function(e){var n,r,i,s,o,u,a,t="",f=0;for(e=this._utf8_encode(e);f<e.length;)s=(n=e.charCodeAt(f++))>>2,o=(3&n)<<4|(r=e.charCodeAt(f++))>>4,u=(15&r)<<2|(i=e.charCodeAt(f++))>>6,a=63&i,isNaN(r)?u=a=64:isNaN(i)&&(a=64),t=t+this._keyStr.charAt(s)+this._keyStr.charAt(o)+this._keyStr.charAt(u)+this._keyStr.charAt(a);return t}},{key:"decode",value:function(e){var n,r,i,o,u,a,t="",f=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");f<e.length;)n=this._keyStr.indexOf(e.charAt(f++))<<2|(o=this._keyStr.indexOf(e.charAt(f++)))>>4,r=(15&o)<<4|(u=this._keyStr.indexOf(e.charAt(f++)))>>2,i=(3&u)<<6|(a=this._keyStr.indexOf(e.charAt(f++))),t+=String.fromCharCode(n),64!=u&&(t+=String.fromCharCode(r)),64!=a&&(t+=String.fromCharCode(i));return t=this._utf8_decode(t)}}]),Base64}(),Url=function(){function Url(){_classCallCheck(this,Url)}return _createClass(Url,[{key:"addQueryString",value:function(url,key,value){key=encodeURI(key),value=encodeURI(value);var urlArray=url.split("?"),queryString="",baseUrl=urlArray[0];urlArray.length>1&&(queryString=urlArray[1]);for(var x,kvp=queryString.split("&"),i=kvp.length;i--;)if((x=kvp[i].split("="))[0]==key){x[1]=value,kvp[i]=x.join("=");break}return i<0&&(kvp[kvp.length]=[key,value].join("=")),"&"==(queryString=kvp.join("&")).substr(0,1)&&(queryString=queryString.substr(1)),baseUrl+"?"+queryString}},{key:"replaceParam",value:function(url){for(var available=!0;available;){var matches=url.match(/{([\w]*)}/);if(null!=matches){var key=matches[1],val=null;if($("#"+key).length>0)val=cresenity.value("#"+key);null==val&&(val=key),url=url.replace("{"+key+"}",val)}else available=!1}return url}}]),Url}(),CUtil=function(){function CUtil(){_classCallCheck(this,CUtil)}return _createClass(CUtil,null,[{key:"tap",value:function(output,callback){return callback(output),output}},{key:"extend",value:function(defaults,options){var prop,extended={};for(prop in defaults)Object.prototype.hasOwnProperty.call(defaults,prop)&&(extended[prop]=defaults[prop]);for(prop in options)Object.prototype.hasOwnProperty.call(options,prop)&&(extended[prop]=options[prop]);return extended}}]),CUtil}(),CF=function(){function CF(){var _this=this;_classCallCheck(this,CF),this.required=void 0===this.required?[]:this.required,this.window=window,this.document=window.document,this.head=this.document.getElementsByTagName("head")[0],this.beforeInitCallback=[],this.afterInitCallback=[],this.config=window.capp,this.config.cssUrl&&this.config.cssUrl.forEach((function(item,index){_this.required.push(item)})),this.config.jsUrl&&this.config.jsUrl.forEach((function(item,index){_this.required.push(item)}))}return _createClass(CF,[{key:"debug",value:function(msg){this.getConfig().debug&&console.log(msg)}},{key:"onBeforeInit",value:function(callback){return this.beforeInitCallback.push(callback),this}},{key:"onAfterInit",value:function(callback){return this.afterInitCallback.push(callback),this}},{key:"getConfig",value:function(){return this.config}},{key:"isUseRequireJs",value:function(){return this.getConfig().requireJs}},{key:"CFVersion",value:function(){return this.getConfig().CFVersion}},{key:"require",value:function(url,callback){if("string"!=typeof url&&(url=url[0]),url){var toPush=url,t=url.split(".").pop();if(~this.required.indexOf(toPush))"function"==typeof callback&&callback();else{if(this.required.push(toPush),url=url.contains("?")?url+"&cappv="+this.CFVersion():url+"?cappv="+this.CFVersion(),null!==document.querySelector('link[href="'+url+'"],script[src="'+url+'"]'))return;var el,string="css"!==t?"<script type='text/javascript'  src='"+url+"'><\/script>":"<link rel='stylesheet' type='text/css' href='"+url+"' />";if("loading"===document.readyState&&window.CanvasRenderingContext2D&&self===parent)document.write(string);else"css"!==t?((el=this.document.createElement("script")).src=url,el.setAttribute("type","text/javascript"),"function"==typeof callback&&(el.onload=callback,el.onreadystatechange=function(){"complete"==this.readyState&&callback()}),this.head.appendChild(el)):((el=this.document.createElement("link")).rel="stylesheet",el.type="text/css",el.href=url,"function"==typeof callback&&(el.onload=callback,el.onreadystatechange=function(){"complete"==this.readyState&&callback()}),this.head.appendChild(el))}}}},{key:"loadJQuery",value:function(callback){if("undefined"==typeof jQuery){var fileref=this.document.createElement("script");fileref.setAttribute("type","text/javascript"),fileref.setAttribute("src",this.getConfig().defaultJQueryUrl),"function"==typeof callback&&(fileref.onload=callback,fileref.onreadystatechange=function(){"complete"==this.readyState&&callback()}),this.head.appendChild(fileref)}else callback()}},{key:"init",value:function(){var _this2=this,arrayJsUrl=this.getConfig().jsUrl;this.beforeInitCallback.forEach((function(item){item()})),this.loadJQuery((function(){void 0!==arrayJsUrl&&arrayJsUrl.forEach((function(item){_this2.required.push(item)}))})),this.afterInitCallback.forEach((function(item){item()}))}}]),CF}(),ScrollToTop=function ScrollToTop(){_classCallCheck(this,ScrollToTop),this.setting={startline:100,scrollto:0,scrollduration:1e3,fadeduration:[500,100]},this.controlHTML='<img src="'+window.capp.base_url+'media/img/up.png" style="width:51px; height:42px" />',this.controlattrs={offsetx:5,offsety:5},this.anchorkeyword="#top",this.state={isvisible:!1,shouldvisible:!1},this.scrollup=function(){this.cssfixedsupport||this.$control.css({opacity:0,zIndex:-1});var dest=isNaN(this.setting.scrollto)?this.setting.scrollto:parseInt(this.setting.scrollto);dest="string"==typeof dest&&1==jQuery("#"+dest).length?jQuery("#"+dest).offset().top:0,this.$body.animate({scrollTop:dest},this.setting.scrollduration)},this.keepfixed=function(){var $window=jQuery(window),controlx=$window.scrollLeft()+$window.width()-this.$control.width()-this.controlattrs.offsetx,controly=$window.scrollTop()+$window.height()-this.$control.height()-this.controlattrs.offsety;this.$control.css({left:controlx+"px",top:controly+"px"})},this.togglecontrol=function(){var scrolltop=jQuery(window).scrollTop();this.cssfixedsupport||this.keepfixed(),this.state.shouldvisible=scrolltop>=this.setting.startline,this.state.shouldvisible&&!this.state.isvisible?(this.$control.stop().animate({opacity:1,zIndex:99999},this.setting.fadeduration[0]),this.state.isvisible=!0):0==this.state.shouldvisible&&this.state.isvisible&&(this.$control.stop().animate({opacity:0,zIndex:-1},this.setting.fadeduration[1]),this.state.isvisible=!1)},this.init=function(){var _this=this;jQuery(document).ready((function($){var mainobj=_this,iebrws=document.all;mainobj.cssfixedsupport=!iebrws||iebrws&&"CSS1Compat"==document.compatMode&&window.XMLHttpRequest,mainobj.$body=window.opera?"CSS1Compat"==document.compatMode?$("html"):$("body"):$("html,body"),mainobj.$control=$('<div id="topcontrol">'+mainobj.controlHTML+"</div>").css({position:mainobj.cssfixedsupport?"fixed":"absolute",bottom:mainobj.controlattrs.offsety,right:mainobj.controlattrs.offsetx,opacity:0,cursor:"pointer",zIndex:99999}).attr({title:"Scroll Back to Top"}).click((function(){return mainobj.scrollup(),!1})).appendTo("body"),document.all&&!window.XMLHttpRequest&&""!=mainobj.$control.text()&&mainobj.$control.css({width:mainobj.$control.width()}),mainobj.togglecontrol(),$('a[href="'+mainobj.anchorkeyword+'"]').click((function(){return mainobj.scrollup(),!1})),$(window).bind("scroll resize",(function(e){mainobj.togglecontrol()}))}))}},Cresenity=function(){function Cresenity(){_classCallCheck(this,Cresenity),this.cf=new CF,this.base64=new Base64,this.url=new Url,this.scrollToTop=new ScrollToTop,this.callback={},this.filesAdded=[]}return _createClass(Cresenity,[{key:"haveCallback",value:function(name){return"function"==typeof this.callback[name]}},{key:"doCallback",value:function(name){if(this.haveCallback(name)){for(var _this$callback,_len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];(_this$callback=this.callback)[name].apply(_this$callback,args)}}},{key:"setCallback",value:function(name,cb){this.callback[name]=cb}},{key:"isUsingRequireJs",value:function(){return void 0===capp.requireJs||capp.requireJs}},{key:"normalizeRequireJs",value:function(){this.isUsingRequireJs()||"function"==typeof define&&define.amd&&(window.define=void 0)}},{key:"isJson",value:function(text){return"string"==typeof text&&/^[\],:{}\s]*$/.test(text.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))}},{key:"loadJs",value:function(filename,callback){var fileref=document.createElement("script");fileref.setAttribute("type","text/javascript"),fileref.setAttribute("src",filename),"function"==typeof callback&&(fileref.onload=callback,fileref.onreadystatechange=function(){"complete"==this.readyState&&callback()}),document.getElementsByTagName("head")[0].appendChild(fileref)}},{key:"loadJsCss",value:function(filename,filetype,callback){if("js"==filetype)(fileref=document.createElement("script")).setAttribute("type","text/javascript"),fileref.setAttribute("src",filename);else if("css"==filetype){var fileref;(fileref=document.createElement("link")).setAttribute("rel","stylesheet"),fileref.setAttribute("type","text/css"),fileref.setAttribute("href",filename)}void 0!==fileref&&("function"==typeof callback&&(fileref.onload=cresenity.handleResponseCallback(callback),fileref.onreadystatechange=function(){"complete"==this.readyState&&cresenity.handleResponseCallback(callback)}),document.getElementsByTagName("head")[0].appendChild(fileref))}},{key:"require",value:function(filename,filetype,callback){-1==this.filesAdded.indexOf("["+filename+"]")?(this.loadJsCss(filename,filetype,callback),this.filesAdded+="["+filename+"]"):(cresenity.filesLoaded++,cresenity.filesLoaded==cresenity.filesNeeded&&callback())}},{key:"handleResponse",value:function(data,callback){if(data.css_require&&data.css_require.length>0)for(var i=0;i<data.css_require.length;i++)cresenity.require(data.css_require[i],"css");if(data.js_require&&data.js_require.length>0)for(i=0;i<data.js_require.length;i++)cresenity.require(data.js_require[i],"js");callback()}},{key:"handleResponseCallback",value:function(callback){cresenity.filesLoaded++,cresenity.filesLoaded==$.cresenity.filesNeeded&&callback()}},{key:"reload",value:function reload(options){var settings=CUtil.extend({method:"get",dataAddition:{},url:"/",reloadType:"reload",onComplete:!1,onSuccess:!1,onBlock:!1,onUnblock:!1},options),method=settings.method,selector=settings.selector,xhr=jQuery(selector).data("xhr");xhr&&xhr.abort();var dataAddition=settings.dataAddition,url=settings.url;url=this.url.replaceParam(url),void 0===dataAddition&&(dataAddition={}),function(settings){$(selector).each((function(){var idTarget=$(this).attr("id");url=cresenity.url.addQueryString(url,"capp_current_container_id",idTarget),function(element){"function"==typeof settings.onBlock?settings.onBlock():cresenity.blockElement($(element)),$(element).data("xhr",$.ajax({type:method,url:url,dataType:"json",data:dataAddition,success:function success(data){cresenity.doCallback("onReloadSuccess",data),cresenity.handleResponse(data,(function(){switch(settings.reloadType){case"after":$(element).after(data.html);break;case"before":$(element).before(data.html);break;case"append":$(element).append(data.html);break;case"prepend":$(element).prepend(data.html);break;default:$(element).html(data.html)}if(data.js&&data.js.length>0){var script=cresenity.base64.decode(data.js);eval(script)}$(element).find(".prettyprint").length>0&&window.prettyPrint&&prettyPrint(),"function"==typeof settings.onSuccess&&settings.onSuccess(data)}))},error:function(xhr,ajaxOptions,thrownError){"abort"!=thrownError&&cresenity.message("error","Error, please call administrator... ("+thrownError+")")},complete:function(){$(element).data("xhr",!1),"function"==typeof settings.onBlock?settings.onUnblock():cresenity.unblockElement($(element)),"function"==typeof settings.onComplete&&settings.onComplete()}}))}(this)}))}(settings)}},{key:"append",value:function(options){options.reloadType="append",this.reload(options)}},{key:"prepend",value:function(options){options.reloadType="prepend",this.reload(options)}},{key:"after",value:function(options){options.reloadType="after",this.reload(options)}},{key:"before",value:function(options){options.reloadType="before",this.reload(options)}},{key:"confirm",value:function(options){var settings=$.extend({method:"get",dataAddition:{},message:"Are you sure?",onConfirmed:!1},options);bootbox.confirm(settings.message,settings.onConfirmed)}},{key:"modal",value:function(options){var settings=$.extend({haveHeader:!1,haveFooter:!1,headerText:"",backdrop:"static",modalClass:!1,onClose:!1,appendTo:!1,footerAction:{}},options);settings.title&&(settings.haveHeader=!0,settings.headerText=settings.title);var modalContainer=jQuery("<div>").addClass("modal");settings.modalClass&&modalContainer.addClass(settings.modalClass),settings.isSidebar&&(modalContainer.addClass("sidebar"),modalContainer.addClass(settings.sidebarMode)),settings.isFull&&modalContainer.addClass("sidebar full");var modalDialog=jQuery("<div>").addClass("modal-dialog modal-xl"),modalContent=jQuery("<div>").addClass("modal-content"),modalHeader=jQuery("<div>").addClass("modal-header"),modalTitle=jQuery("<div>").addClass("modal-title"),modalButtonClose=jQuery('<button type="button" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></button>');modalButtonClose.click((function(e){modalButtonClose.closest(".modal").modal("hide")}));var modalBody=jQuery("<div>").addClass("modal-body"),modalFooter=jQuery("<div>").addClass("modal-footer");modalDialog.append(modalContent),modalContainer.append(modalDialog),settings.haveHeader&&(modalTitle.html(settings.headerText),modalHeader.append(modalTitle).append(modalButtonClose),modalContent.append(modalHeader)),modalDialog.append(modalContent),settings.haveFooter&&modalContent.append(modalFooter),modalContent.append(modalBody);var appendTo=settings.appendTo;if(void 0!==appendTo&&appendTo||(appendTo=$("body")),modalContainer.appendTo(appendTo),modalContainer.addClass("capp-modal"),modalContainer.on("hidden.bs.modal",(function(e){if(cresenity.modalElements.length>0){var lastModal=cresenity.modalElements[cresenity.modalElements.length-1];lastModal&&lastModal.get(0)===$(e.target).get(0)&&function(modal){next=new function(){var _this=this;this.isRunning=!1,this.callback=function(delay){void 0===delay&&(delay=0),"NaN"==typeof parseInt(delay)&&(delay=0),setTimeout((function(){$(modal).remove(),cresenity.modalElements.pop(),$(".modal:visible").length>0?$("body").hasClass("modal-open")||$("body").addClass("modal-open"):$("body").removeClass("modal-open")}),delay),_this.isRunning=!0}},"function"==typeof settings.onClose&&settings.onClose(e,next.callback),next.isRunning||next.callback()}(lastModal)}})),modalContainer.on("shown.bs.modal",(function(e){cresenity.modalElements.push($(this))})),settings.message&&modalBody.append(settings.message),settings.reload){var reloadOptions=settings.reload;reloadOptions.selector=modalBody,cresenity.reload(reloadOptions)}return modalContainer.modal({backdrop:settings.backdrop}),modalContainer}},{key:"closeLastModal",value:function(options){cresenity.modalElements.length>0&&cresenity.modalElements[cresenity.modalElements.length-1].modal("hide")}},{key:"closeDialog",value:function(options){this.closeLastModal(options)}},{key:"ajax",value:function(options){var settings=$.extend({block:!0,url:window.location.href,method:"post"},options),dataAddition=settings.dataAddition,url=settings.url;url=this.url.replaceParam(url),void 0===dataAddition&&(dataAddition={}),settings.block&&cresenity.blockPage();var ajaxOptions={url:url,dataType:"json",data:dataAddition,type:settings.method,success:function(response){var onSuccess=function(){},onError=function(errMessage){cresenity.showError(errMessage)};"function"==typeof settings.onSuccess&&(onSuccess=settings.onSuccess),"function"==typeof settings.onError&&(onError=settings.onError),1==settings.handleJsonResponse?cresenity.handleJsonResponse(response,onSuccess,onError):onSuccess(response)},error:function(xhr,ajaxOptions,thrownError){"abort"!=thrownError&&(console.log(thrownError),cresenity.showError(thrownError))},complete:function(){settings.block&&cresenity.unblockPage(),"function"==typeof settings.onComplete&&settings.onComplete()}};return $.ajax(ajaxOptions)}},{key:"ajaxSubmit",value:function(options){var settings=$.extend({},options),selector=settings.selector;return $(selector).each((function(){var formAjaxUrl=$(this).attr("action")||"",formMethod=$(this).attr("method")||"get";!function(element){cresenity.blockElement($(element));var validationIsValid=!0,ajaxOptions={url:formAjaxUrl,dataType:"json",type:formMethod,beforeSubmit:function(){return"function"!=typeof $(element).validate||(validationIsValid=$(element).validate().form())},success:function(response){var onSuccess=function(){},onError=function(errMessage){cresenity.showError(errMessage)};haveOnSuccess=!1,"function"==typeof settings.onSuccess&&validationIsValid&&(onSuccess=settings.onSuccess,haveOnSuccess=!0),"function"==typeof settings.onError&&validationIsValid&&(onError=settings.onError),validationIsValid&&(1==settings.handleJsonResponse&&haveOnSuccess?cresenity.handleJsonResponse(response,onSuccess,onError):onSuccess(response))},complete:function(){cresenity.unblockElement($(element)),"function"==typeof settings.onComplete&&validationIsValid&&settings.onComplete()}};$(element).ajaxSubmit(ajaxOptions)}(this)})),!1}},{key:"debug",value:function(message){this.cf.getConfig().debug&&console.log(message)}},{key:"message",value:function(type,_message,alertType,callback){this.debug(_message),alertType=void 0!==alertType?alertType:"notify";var container=$("#container");0==container.length&&(container=$("body")),"bootbox"==alertType&&(void 0===callback?bootbox.alert(_message):bootbox.alert(_message,callback)),"notify"==alertType&&(obj=$("<div>"),container.prepend(obj),obj.addClass("notifications"),obj.addClass("top-right"),obj.notify({message:{text:_message},type:type}).show())}},{key:"blockPage",value:function(options){var settings=$.extend({innerMessage:'<div class="sk-folding-cube sk-primary"><div class="sk-cube1 sk-cube"></div><div class="sk-cube2 sk-cube"></div><div class="sk-cube4 sk-cube"></div><div class="sk-cube3 sk-cube"></div></div><h5 style="color: #444">LOADING...</h5>'},options);$.blockUI({message:settings.innerMessage,css:{backgroundColor:"transparent",border:"0",zIndex:9999999},overlayCSS:{backgroundColor:"#fff",opacity:.8,zIndex:9999990}})}},{key:"scrollTo",value:function(element,container){void 0===container&&(container=document.body),$(container).animate({scrollTop:$(element).offset().top-($(container).offset().top+$(container).scrollTop())})}},{key:"formatCurrency",value:function(rp){rp=""+rp;var rupiah="",vfloat="",ds=window.capp.decimal_separator,ts=window.capp.thousand_separator,dd=window.capp.decimal_digit,minus_str=(dd=parseInt(dd),"");for(rp.indexOf("-")>=0&&(minus_str=rp.substring(rp.indexOf("-"),1),rp=rp.substring(rp.indexOf("-")+1)),rp.indexOf(".")>=0&&(vfloat=rp.substring(rp.indexOf(".")),rp=rp.substring(0,rp.indexOf("."))),p=rp.length;p>3;)rupiah=ts+rp.substring(p-3)+rupiah,l=rp.length-3,rp=rp.substring(0,l),p=rp.length;return rupiah=rp+rupiah,(vfloat=vfloat.replace(".",ds)).length>dd&&(vfloat=vfloat.substring(0,dd+1)),minus_str+rupiah+vfloat}},{key:"unblockPage",value:function(){$.unblockUI()}},{key:"blockElement",value:function(selector,options){var settings=$.extend({innerMessage:'<div class="sk-wave sk-primary"><div class="sk-rect sk-rect1"></div> <div class="sk-rect sk-rect2"></div> <div class="sk-rect sk-rect3"></div> <div class="sk-rect sk-rect4"></div> <div class="sk-rect sk-rect5"></div></div>'},options);$(selector).block({message:settings.innerMessage,css:{backgroundColor:"transparent",border:"0"},overlayCSS:{backgroundColor:"#fff",opacity:.8}})}},{key:"unblockElement",value:function(selector){$(selector).unblock()}},{key:"value",value:function(elm){return 0==(elm=jQuery(elm)).length?null:("checkbox"!=elm.attr("type")||elm.is(":checked"))&&("radio"!=elm.attr("type")||elm.is(":checked"))?void 0!==elm.val()?elm.val():void 0!==elm.attr("value")?elm.attr("value"):elm.html():null}},{key:"initConfirm",value:function(){$("body").attr("data-confirm-initialized")||(jQuery(document).on("click","a.confirm, button.confirm",(function(e){var ahref=$(this).attr("href"),message=$(this).attr("data-confirm-message"),no_double=$(this).attr("data-no-double"),clicked=$(this).attr("data-clicked"),btn=jQuery(this);return btn.attr("data-clicked","1"),no_double&&1==clicked||(message=message?$.cresenity.base64.decode(message):window.capp.label_confirm,str_confirm=window.capp.label_ok,str_cancel=window.capp.label_cancel,e.preventDefault(),e.stopPropagation(),btn.off("click"),bootbox.confirm({className:"capp-modal-confirm",message:message,callback:function(confirmed){confirmed?ahref?window.location.href=ahref:"submit"==btn.attr("type")?btn.closest("form").submit():btn.on("click"):btn.removeAttr("data-clicked"),setTimeout((function(){$(".modal:visible").length>0?$("body").addClass("modal-open"):$("body").removeClass("modal-open")}),750)}})),!1})),$("body").attr("data-confirm-initialized","1")),$("body").attr("data-confirm-submit-initialized")||(jQuery(document).on("click","input[type=submit].confirm",(function(e){var submitted=$(this).attr("data-submitted"),btn=jQuery(this);if("1"==submitted)return!1;btn.attr("data-submitted","1");var message=$(this).attr("data-confirm-message");return message=message?$.cresenity.base64.decode(message):window.capp.label_confirm,str_confirm=window.capp.label_ok,str_cancel=window.capp.label_cancel,bootbox.confirm(message,str_cancel,str_confirm,(function(confirmed){confirmed?jQuery(e.target).closest("form").submit():btn.removeAttr("data-submitted")})),!1})),$("body").attr("data-confirm-submit-initialized","1")),jQuery(document).ready((function(){jQuery("#toggle-subnavbar").click((function(){"Hide"==jQuery("#toggle-subnavbar span").html()?(jQuery("#subnavbar").slideUp("slow"),jQuery("#toggle-subnavbar span").html("Show")):(jQuery("#subnavbar").slideDown("slow"),jQuery("#toggle-subnavbar span").html("Hide"))})),jQuery("#toggle-fullscreen").click((function(){$.cresenity.fullscreen(document.documentElement)}))}))}},{key:"initClock",value:function(){this.cf.getConfig().haveClock&&$(document).ready((function(){$("#servertime").serverTime({ajaxFile:window.capp.base_url+"cresenity/server_time",displayDateFormat:"yyyy-mm-dd HH:MM:ss"})}))}},{key:"init",value:function(){var _this2=this;this.cf.onBeforeInit((function(){_this2.normalizeRequireJs()})),this.cf.onAfterInit((function(){_this2.cf.getConfig().haveScrollToTop&&(document.getElementById("topcontrol")||_this2.scrollToTop.init()),_this2.initConfirm()})),this.cf.init()}},{key:"downloadProgress",value:function(options){var settings=$.extend({method:"get",dataAddition:{},url:"/",onComplete:!1,onSuccess:!1,onBlock:!1,onUnblock:!1},options),method=settings.method,xhr=jQuery(window).data("cappXhrProgress");xhr&&xhr.abort();var dataAddition=settings.dataAddition,url=settings.url;url=this.url.replaceParam(url),void 0===dataAddition&&(dataAddition={}),function(settings){var element;element=this,"function"==typeof settings.onBlock?settings.onBlock():cresenity.blockPage(),$(element).data("xhr",$.ajax({type:method,url:url,dataType:"json",data:dataAddition,success:function(response){cresenity.handleJsonResponse(response,(function(data){var progressUrl=data.progressUrl,progressContainer=$("<div>").addClass("progress-container"),interval=setInterval((function(){$.ajax({type:method,url:progressUrl,dataType:"json",success:function(response){cresenity.handleJsonResponse(response,(function(data){if("DONE"==data.state){progressContainer.find(".progress-container-status").empty();var innerStatus=$("<div>"),innerStatusLabel=$("<label>",{class:"mb-3 d-block"}).append("Your file is ready"),linkDownload=$("<a>",{target:"_blank",href:data.fileUrl,class:"btn btn-primary"}).append("Download"),linkClose=$("<a>",{href:"javascript:;",class:"btn btn-primary ml-3"}).append("Close");innerStatus.append(innerStatusLabel),innerStatus.append(linkDownload),innerStatus.append(linkClose),progressContainer.find(".progress-container-status").append(innerStatus),linkClose.click((function(){cresenity.closeLastModal()})),clearInterval(interval)}}))}})}),3e3),innerStatus=$("<div>"),innerStatusLabel=$("<label>",{class:"mb-4"}).append("Please Wait..."),innerStatusAnimation=$("<div>").append('<div class="sk-fading-circle sk-primary"><div class="sk-circle1 sk-circle"></div><div class="sk-circle2 sk-circle"></div><div class="sk-circle3 sk-circle"></div><div class="sk-circle4 sk-circle"></div><div class="sk-circle5 sk-circle"></div><div class="sk-circle6 sk-circle"></div><div class="sk-circle7 sk-circle"></div><div class="sk-circle8 sk-circle"></div><div class="sk-circle9 sk-circle"></div><div class="sk-circle10 sk-circle"></div><div class="sk-circle11 sk-circle"></div><div class="sk-circle12 sk-circle"></div></div>'),innerStatusAction=$("<div>",{class:"text-center my-3"}),innerStatusCancelButton=$("<button>",{class:"btn btn-primary"}).append("Cancel");innerStatusAction.append(innerStatusCancelButton),innerStatus.append(innerStatusLabel),innerStatus.append(innerStatusAnimation),innerStatus.append(innerStatusAction),progressContainer.append($("<div>").addClass("progress-container-status").append(innerStatus)),innerStatusCancelButton.click((function(){clearInterval(interval),cresenity.closeLastModal()})),cresenity.modal({message:progressContainer,modalClass:"modal-download-progress"})}))},error:function(xhr,ajaxOptions,thrownError){"abort"!=thrownError&&cresenity.message("error","Error, please call administrator... ("+thrownError+")")},complete:function(){$(element).data("xhr",!1),"function"==typeof settings.onBlock?settings.onUnblock():cresenity.unblockPage(),"function"==typeof settings.onComplete&&settings.onComplete()}}))}(settings)}}]),Cresenity}();window.cresenity=new Cresenity,window.cresenity.init(),document.addEventListener("DOMContentLoaded",(function(){}))}));
//# sourceMappingURL=cres.js.map
